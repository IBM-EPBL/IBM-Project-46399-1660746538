#for i in range(1,23):
    #model.layers[i].trainable = False
In [9]:
model.summary()
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            (None, 192, 192, 3)  0                                            
__________________________________________________________________________________________________
conv_1 (Conv2D)                 (None, 192, 192, 32) 864         input_3[0][0]                    
__________________________________________________________________________________________________
norm_1 (BatchNormalization)     (None, 192, 192, 32) 128         conv_1[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_44 (LeakyReLU)      (None, 192, 192, 32) 0           norm_1[0][0]                     
__________________________________________________________________________________________________
max_pooling2d_11 (MaxPooling2D) (None, 96, 96, 32)   0           leaky_re_lu_44[0][0]             
__________________________________________________________________________________________________
conv_2 (Conv2D)                 (None, 96, 96, 64)   18432       max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
norm_2 (BatchNormalization)     (None, 96, 96, 64)   256         conv_2[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_45 (LeakyReLU)      (None, 96, 96, 64)   0           norm_2[0][0]                     
__________________________________________________________________________________________________
max_pooling2d_12 (MaxPooling2D) (None, 48, 48, 64)   0           leaky_re_lu_45[0][0]             
__________________________________________________________________________________________________
conv_3 (Conv2D)                 (None, 48, 48, 128)  73728       max_pooling2d_12[0][0]           
__________________________________________________________________________________________________
norm_3 (BatchNormalization)     (None, 48, 48, 128)  512         conv_3[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_46 (LeakyReLU)      (None, 48, 48, 128)  0           norm_3[0][0]                     
__________________________________________________________________________________________________
conv_4 (Conv2D)                 (None, 48, 48, 64)   8192        leaky_re_lu_46[0][0]             
__________________________________________________________________________________________________
norm_4 (BatchNormalization)     (None, 48, 48, 64)   256         conv_4[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_47 (LeakyReLU)      (None, 48, 48, 64)   0           norm_4[0][0]                     
__________________________________________________________________________________________________
conv_5 (Conv2D)                 (None, 48, 48, 128)  73728       leaky_re_lu_47[0][0]             
__________________________________________________________________________________________________
norm_5 (BatchNormalization)     (None, 48, 48, 128)  512         conv_5[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_48 (LeakyReLU)      (None, 48, 48, 128)  0           norm_5[0][0]                     
__________________________________________________________________________________________________
max_pooling2d_13 (MaxPooling2D) (None, 24, 24, 128)  0           leaky_re_lu_48[0][0]             
__________________________________________________________________________________________________
conv_6 (Conv2D)                 (None, 24, 24, 256)  294912      max_pooling2d_13[0][0]           
__________________________________________________________________________________________________
norm_6 (BatchNormalization)     (None, 24, 24, 256)  1024        conv_6[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_49 (LeakyReLU)      (None, 24, 24, 256)  0           norm_6[0][0]                     
__________________________________________________________________________________________________
conv_7 (Conv2D)                 (None, 24, 24, 128)  32768       leaky_re_lu_49[0][0]             
__________________________________________________________________________________________________
norm_7 (BatchNormalization)     (None, 24, 24, 128)  512         conv_7[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_50 (LeakyReLU)      (None, 24, 24, 128)  0           norm_7[0][0]                     
__________________________________________________________________________________________________
conv_8 (Conv2D)                 (None, 24, 24, 256)  294912      leaky_re_lu_50[0][0]             
__________________________________________________________________________________________________
norm_8 (BatchNormalization)     (None, 24, 24, 256)  1024        conv_8[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_51 (LeakyReLU)      (None, 24, 24, 256)  0           norm_8[0][0]                     
__________________________________________________________________________________________________
max_pooling2d_14 (MaxPooling2D) (None, 12, 12, 256)  0           leaky_re_lu_51[0][0]             
__________________________________________________________________________________________________
conv_9 (Conv2D)                 (None, 12, 12, 512)  1179648     max_pooling2d_14[0][0]           
__________________________________________________________________________________________________
norm_9 (BatchNormalization)     (None, 12, 12, 512)  2048        conv_9[0][0]                     
__________________________________________________________________________________________________
leaky_re_lu_52 (LeakyReLU)      (None, 12, 12, 512)  0           norm_9[0][0]                     
__________________________________________________________________________________________________
conv_10 (Conv2D)                (None, 12, 12, 256)  131072      leaky_re_lu_52[0][0]             
__________________________________________________________________________________________________
norm_10 (BatchNormalization)    (None, 12, 12, 256)  1024        conv_10[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_53 (LeakyReLU)      (None, 12, 12, 256)  0           norm_10[0][0]                    
__________________________________________________________________________________________________
conv_11 (Conv2D)                (None, 12, 12, 512)  1179648     leaky_re_lu_53[0][0]             
__________________________________________________________________________________________________
norm_11 (BatchNormalization)    (None, 12, 12, 512)  2048        conv_11[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_54 (LeakyReLU)      (None, 12, 12, 512)  0           norm_11[0][0]                    
__________________________________________________________________________________________________
conv_12 (Conv2D)                (None, 12, 12, 256)  131072      leaky_re_lu_54[0][0]             
__________________________________________________________________________________________________
norm_12 (BatchNormalization)    (None, 12, 12, 256)  1024        conv_12[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_55 (LeakyReLU)      (None, 12, 12, 256)  0           norm_12[0][0]                    
__________________________________________________________________________________________________
conv_13 (Conv2D)                (None, 12, 12, 512)  1179648     leaky_re_lu_55[0][0]             
__________________________________________________________________________________________________
norm_13 (BatchNormalization)    (None, 12, 12, 512)  2048        conv_13[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_56 (LeakyReLU)      (None, 12, 12, 512)  0           norm_13[0][0]                    
__________________________________________________________________________________________________
max_pooling2d_15 (MaxPooling2D) (None, 6, 6, 512)    0           leaky_re_lu_56[0][0]             
__________________________________________________________________________________________________
conv_14 (Conv2D)                (None, 6, 6, 1024)   4718592     max_pooling2d_15[0][0]           
__________________________________________________________________________________________________
norm_14 (BatchNormalization)    (None, 6, 6, 1024)   4096        conv_14[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_57 (LeakyReLU)      (None, 6, 6, 1024)   0           norm_14[0][0]                    
__________________________________________________________________________________________________
conv_15 (Conv2D)                (None, 6, 6, 512)    524288      leaky_re_lu_57[0][0]             
__________________________________________________________________________________________________
norm_15 (BatchNormalization)    (None, 6, 6, 512)    2048        conv_15[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_58 (LeakyReLU)      (None, 6, 6, 512)    0           norm_15[0][0]                    
__________________________________________________________________________________________________
conv_16 (Conv2D)                (None, 6, 6, 1024)   4718592     leaky_re_lu_58[0][0]             
__________________________________________________________________________________________________
norm_16 (BatchNormalization)    (None, 6, 6, 1024)   4096        conv_16[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_59 (LeakyReLU)      (None, 6, 6, 1024)   0           norm_16[0][0]                    
__________________________________________________________________________________________________
conv_17 (Conv2D)                (None, 6, 6, 512)    524288      leaky_re_lu_59[0][0]             
__________________________________________________________________________________________________
norm_17 (BatchNormalization)    (None, 6, 6, 512)    2048        conv_17[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_60 (LeakyReLU)      (None, 6, 6, 512)    0           norm_17[0][0]                    
__________________________________________________________________________________________________
conv_18 (Conv2D)                (None, 6, 6, 1024)   4718592     leaky_re_lu_60[0][0]             
__________________________________________________________________________________________________
norm_18 (BatchNormalization)    (None, 6, 6, 1024)   4096        conv_18[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_61 (LeakyReLU)      (None, 6, 6, 1024)   0           norm_18[0][0]                    
__________________________________________________________________________________________________
conv_19 (Conv2D)                (None, 6, 6, 1024)   9437184     leaky_re_lu_61[0][0]             
__________________________________________________________________________________________________
norm_19 (BatchNormalization)    (None, 6, 6, 1024)   4096        conv_19[0][0]                    
__________________________________________________________________________________________________
conv_21 (Conv2D)                (None, 12, 12, 64)   32768       leaky_re_lu_56[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_62 (LeakyReLU)      (None, 6, 6, 1024)   0           norm_19[0][0]                    
__________________________________________________________________________________________________
norm_21 (BatchNormalization)    (None, 12, 12, 64)   256         conv_21[0][0]                    
__________________________________________________________________________________________________
conv_20 (Conv2D)                (None, 6, 6, 1024)   9437184     leaky_re_lu_62[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_64 (LeakyReLU)      (None, 12, 12, 64)   0           norm_21[0][0]                    
__________________________________________________________________________________________________
norm_20 (BatchNormalization)    (None, 6, 6, 1024)   4096        conv_20[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 6, 6, 256)    0           leaky_re_lu_64[0][0]             
__________________________________________________________________________________________________
leaky_re_lu_63 (LeakyReLU)      (None, 6, 6, 1024)   0           norm_20[0][0]                    
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 6, 6, 1280)   0           lambda_2[0][0]                   
                                                                 leaky_re_lu_63[0][0]             
__________________________________________________________________________________________________
conv_22 (Conv2D)                (None, 6, 6, 1024)   11796480    concatenate_2[0][0]              
__________________________________________________________________________________________________
norm_22 (BatchNormalization)    (None, 6, 6, 1024)   4096        conv_22[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_65 (LeakyReLU)      (None, 6, 6, 1024)   0           norm_22[0][0]                    
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 36864)        0           leaky_re_lu_65[0][0]             
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36864)        0           flatten_2[0][0]                  
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 4)            147460      dropout_2[0][0]                  
==================================================================================================
Total params: 50,695,396
Trainable params: 50,674,724
Non-trainable params: 20,672
__________________________________________________________________________________________________
